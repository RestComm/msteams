(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},180:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(85),o=n.n(i),c=(n(100),n(23)),l=n(24),s=n(26),u=n(25),m=n(13),h=n(184),d=n(186),p=n(187),v=n(11),f=n.n(v),b=n(21),g=n(45),y=n(84),w=n(33),E=n(185),O=new y.a({link:new w.a({uri:"/graphql",credentials:"same-origin"}),cache:new E.a}),T=function(){return r.a.createElement("div",null,r.a.createElement("div",null,"TeleSax Demo application allows you to communicate via SMS to your trusted partners. You will need to register a number first on RestComm and configure the same to be used for sending and receiving message. See the configuration page.",r.a.createElement("br",null),"NOTE: The Restcomm number should support message and voice"))},S=function(){return r.a.createElement("div",null,"Team Tabs")},j=n(58),C=n.n(j),I=n(51),k=n(91),x=n(59),N=n(60);function z(){var e=Object(x.a)(["\n  query getMemberById($teamId: String!) {\n    getMemberById(teamId: $teamId) {\n      teamId\n      teamName\n      channelId\n      channelName\n      phoneNumber\n    }\n  }\n"]);return z=function(){return e},e}function M(){var e=Object(x.a)(["\n  mutation registerMember($member: MSTeamRegister) {\n    registerMember(member: $member) {\n      result\n      desc\n    }\n  }\n"]);return M=function(){return e},e}var P=Object(N.a)(M()),R=Object(N.a)(z()),B=n(52),H=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onTextChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(B.a)({},a,r)),r.length>6&&n.props.onTextChange(r)},n.state={restcommpstn:e.value||""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(b.TeamsThemeContext.Consumer,null,function(t){var n=t.rem,a=t.font,i=a.sizes,o=a.weights,c={header:Object(I.a)({},i.title,o.semibold),input:{paddingTop:n(.5),width:"50%"}};return r.a.createElement(b.Panel,null,r.a.createElement(b.PanelHeader,null,r.a.createElement("div",{style:c.header},"RestComm PTSN Number")),r.a.createElement(b.PanelBody,null,r.a.createElement(b.Input,{name:"restcommpstn",id:"restcommpstn",autoFocus:!0,style:c.input,placeholder:"PTSN Number",label:"Enter the RestComm PTSN Number",errorLabel:e.state.restcommpstn?null:"This value is required",value:e.state.restcommpstn,onChange:function(t){return e.onTextChange(t)},required:!0})),r.a.createElement(b.PanelFooter,null))})}}]),t}(a.Component),U=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSaveSettings=function(){var e=Object(k.a)(C.a.mark(function e(t){var a,r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.location.protocol+"//"+window.location.host,e.prev=1,f.a.settings.setSettings({contentUrl:a,entityId:a}),e.next=5,n.props.mutate({variables:{member:Object(I.a)({phoneNumber:n.state.phoneNumber},n.currentTeam)}});case 5:r=e.sent,console.log(r),t.notifySuccess(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.notifyFailure(),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}(),n.onTextChange=function(e){n.setState({phoneNumber:e}),f.a.settings.setValidityState(!0)},n.state={phoneNumber:"",teamId:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.a.initialize(),f.a.getContext(function(t){t&&(e.setState({teamId:t.teamId}),e.currentTeam={teamId:t.teamId,teamName:t.teamName,channelId:t.channelId,channelName:t.channelName,locale:t.locale,loginHint:t.loginHint})}),f.a.settings.registerOnSaveHandler(this.handleSaveSettings)}},{key:"componentWillUnmount",value:function(){f.a.settings.registerOnRemoveHandler(this.handleSaveSettings)}},{key:"render",value:function(){var e=this;return r.a.createElement(g.Query,{query:R,variables:{teamId:this.state.teamId}},function(t){var n=t.loading,a=t.data,i=t.error;if(n)return r.a.createElement("div",null,"Loading....");if(i)return r.a.createElement("div",null,"Unknown error. Try again");var o="";return a.getMemberById&&(o=a.getMemberById.phoneNumber),r.a.createElement("div",null,r.a.createElement(H,{value:o,onTextChange:e.onTextChange}))})}}]),t}(a.Component),q=Object(g.graphql)(P)(U),D=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){f.a.initialize();var e={};window.location.search.substr(1).split("&").forEach(function(t){var n=t.split("="),a=n[0],r=n[1]&&decodeURIComponent(n[1]);e[a]=r});var t=e.authorizationUrl;t&&window.location.assign(t)}},{key:"render",value:function(){return r.a.createElement("div",null,"Loading...")}}]),t}(a.Component),F=function(e){function t(e){var n;Object(c.a)(this,t),n=Object(s.a)(this,Object(u.a)(t).call(this,e));var a=e.match,r=a.params.verificationCode;return n.isfailed="failed"===a.params.result,n.state={verificationCode:r||""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){f.a.initialize(),this.isfailed||f.a.authentication.notifySuccess("'".concat(this.state.verificationCode,"'"))}},{key:"render",value:function(){return this.isfailed?r.a.createElement("div",null,"There was an error authenticating with Azure Provider. Please try again"):r.a.createElement("div",{id:"instructionText",style:{display:"none"}},r.a.createElement("div",{class:"instruction-text"},r.a.createElement("p",null,"You're almost there!"),r.a.createElement("span",{class:"verification-code"},this.state.verificationCode),r.a.createElement("p",null,"in the Microsoft Teams chat window.")))}}]),t}(a.Component),L=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={theme:b.ThemeStyle.Light,fontSize:16},n.pageFontSize=function(){var e=window.getComputedStyle(document.getElementsByTagName("html")[0]).getPropertyValue("font-size");e=e.replace("px","");var t=parseInt(e,10);return t||(t=16),t},n.updateTheme=function(e){var t;switch(e){case"dark":t=b.ThemeStyle.Dark;break;case"contrast":t=b.ThemeStyle.HighContrast;break;case"default":default:t=b.ThemeStyle.Light}n.setState({theme:t})},n.getQueryVariable=function(e){var t=window.location.search.substring(1).split("&"),n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value.split("=");if(decodeURIComponent(c[0])===e)return decodeURIComponent(c[1])}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return null},n.inTeams=function(){try{return window.self!==window.top}catch(e){return!0}},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.updateTheme(this.getQueryVariable("theme")),this.setState({fontSize:this.pageFontSize()}),this.inTeams()&&(f.a.initialize(),f.a.registerOnThemeChangeHandler(this.updateTheme))}},{key:"render",value:function(){var e=Object(b.getContext)({baseFontSize:this.state.fontSize,style:this.state.theme});return r.a.createElement(g.ApolloProvider,{client:O},r.a.createElement(b.TeamsThemeContext.Provider,{value:e},r.a.createElement(h.a,null,r.a.createElement(d.a,null,r.a.createElement(p.a,{exact:!0,path:"/personal",component:T}),r.a.createElement(p.a,{path:"/team",component:S}),r.a.createElement(p.a,{path:"/configure",component:q}),r.a.createElement(p.a,{path:"/auth/start",component:D}),r.a.createElement(p.a,{path:"/cbresult/:verificationCode/:result",component:F}),r.a.createElement(p.a,{path:"/",component:T})))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},95:function(e,t,n){e.exports=n(180)}},[[95,2,1]]]);
//# sourceMappingURL=main.dcc3fb3d.chunk.js.map