(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){e.exports=n(187)},109:function(e,t,n){},187:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(51),o=n.n(i),c=(n(109),n(16)),l=n(17),u=n(19),s=n(18),m=n(20),d=n(191),h=n(193),p=n(194),b=n(11),f=n.n(b),g=n(12),v=n(45),y=n(90),w=n(43),O=n(192),E=new y.a({link:new w.a({uri:"/graphql",credentials:"same-origin"}),cache:new O.a}),j=n(36),T=n(46),S=n(96),k=n.n(S);function C(){var e=Object(j.a)(["\n  padding: 25px;\n"]);return C=function(){return e},e}function x(){var e=Object(j.a)(["\n  margin: 30px 20px;\n  text-align: center;\n"]);return x=function(){return e},e}function I(){var e=Object(j.a)(["\n  text-align: center;\n  padding-top: 25px;\n  font-weight: 600;\n  font-size: 34px;\n  color: #252e4e;\n"]);return I=function(){return e},e}function N(){var e=Object(j.a)(["\n  padding-top: 25px !important;\n  padding-bottom: 25px !important;\n  background-color: #e8f6fb;\n  background-image: url(",");\n  height: 400px;\n  background-repeat: no-repeat;\n  background-position: center center;\n  -webkit-background-size: contain;\n  -moz-background-size: contain;\n  -o-background-size: contain;\n  background-size: contain;\n"]);return N=function(){return e},e}var z=T.a.div(N(),function(e){return e.Image}),M=T.a.h1(I()),P=T.a.div(x()),B=T.a.div(C()),R=function(){return r.a.createElement(B,null,r.a.createElement(z,{Image:k.a},r.a.createElement(M,null,"Making Business Communications Simple")),r.a.createElement(P,null,"TeleSax Demo application allows you to communicate via SMS to your trusted partners. Your system administrator needs to enable RestComm PSTN number in your profile.",r.a.createElement("br",null),r.a.createElement("br",null),"NOTE: The Restcomm number should support message and voice"))},H=function(){return r.a.createElement("div",null,"Team Tabs")},U=n(66),q=n.n(U),D=n(52),F=n(99),L=n(67);function $(){var e=Object(j.a)(["\n  query getMemberById($teamId: String!) {\n    getMemberById(teamId: $teamId) {\n      teamId\n      teamName\n      channelId\n      channelName\n      phoneNumber\n    }\n  }\n"]);return $=function(){return e},e}function V(){var e=Object(j.a)(["\n  mutation registerMember($member: MSTeamRegister) {\n    registerMember(member: $member) {\n      result\n      desc\n    }\n  }\n"]);return V=function(){return e},e}var A=Object(L.a)(V()),Q=Object(L.a)($()),W=n(53),J=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).onTextChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(W.a)({},a,r)),r.length>6&&n.props.onTextChange(r)},n.state={restcommpstn:e.value||""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(g.TeamsThemeContext.Consumer,null,function(t){var n=t.rem,a=t.font,i=a.sizes,o=a.weights,c={header:Object(D.a)({},i.title,o.semibold),input:{paddingTop:n(.5),width:"50%"}};return r.a.createElement(g.Panel,null,r.a.createElement(g.PanelHeader,null,r.a.createElement("div",{style:c.header},"RestComm PTSN Number")),r.a.createElement(g.PanelBody,null,r.a.createElement(g.Input,{name:"restcommpstn",id:"restcommpstn",autoFocus:!0,style:c.input,placeholder:"PTSN Number",label:"Enter the RestComm PTSN Number",errorLabel:e.state.restcommpstn?null:"This value is required",value:e.state.restcommpstn,onChange:function(t){return e.onTextChange(t)},required:!0})),r.a.createElement(g.PanelFooter,null))})}}]),t}(a.Component),Y=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleSaveSettings=function(){var e=Object(F.a)(q.a.mark(function e(t){var a,r;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.location.protocol+"//"+window.location.host,e.prev=1,f.a.settings.setSettings({contentUrl:a,entityId:a}),e.next=5,n.props.mutate({variables:{member:Object(D.a)({phoneNumber:n.state.phoneNumber},n.currentTeam)}});case 5:r=e.sent,console.log(r),t.notifySuccess(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.notifyFailure(),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}(),n.onTextChange=function(e){n.setState({phoneNumber:e}),f.a.settings.setValidityState(!0)},n.state={phoneNumber:"",teamId:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.a.initialize(),f.a.getContext(function(t){t&&(e.setState({teamId:t.teamId}),e.currentTeam={teamId:t.teamId,teamName:t.teamName,channelId:t.channelId,channelName:t.channelName,locale:t.locale,loginHint:t.loginHint})}),f.a.settings.registerOnSaveHandler(this.handleSaveSettings)}},{key:"componentWillUnmount",value:function(){f.a.settings.registerOnRemoveHandler(this.handleSaveSettings)}},{key:"render",value:function(){var e=this;return r.a.createElement(v.Query,{query:Q,variables:{teamId:this.state.teamId}},function(t){var n=t.loading,a=t.data,i=t.error;if(n)return r.a.createElement("div",null,"Loading....");if(i)return r.a.createElement("div",null,"Unknown error. Try again");var o="";return a.getMemberById&&(o=a.getMemberById.phoneNumber),r.a.createElement("div",null,r.a.createElement(J,{value:o,onTextChange:e.onTextChange}))})}}]),t}(a.Component),G=Object(v.graphql)(A)(Y),K=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){f.a.initialize();var e={};window.location.search.substr(1).split("&").forEach(function(t){var n=t.split("="),a=n[0],r=n[1]&&decodeURIComponent(n[1]);e[a]=r});var t=e.authorizationUrl;t&&window.location.assign(t)}},{key:"render",value:function(){return r.a.createElement("div",null,"Loading...")}}]),t}(a.Component),X=function(e){function t(e){var n;Object(c.a)(this,t),n=Object(u.a)(this,Object(s.a)(t).call(this,e));var a=e.match,r=a.params.verificationCode;return n.isfailed="failed"===a.params.result,n.state={verificationCode:r||""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){f.a.initialize(),this.isfailed||f.a.authentication.notifySuccess("'".concat(this.state.verificationCode,"'"))}},{key:"render",value:function(){return this.isfailed?r.a.createElement("div",null,"There was an error authenticating with Azure Provider. Please try again"):r.a.createElement("div",{id:"instructionText",style:{display:"none"}},r.a.createElement("div",{class:"instruction-text"},r.a.createElement("p",null,"You're almost there!"),r.a.createElement("span",{class:"verification-code"},this.state.verificationCode),r.a.createElement("p",null,"in the Microsoft Teams chat window.")))}}]),t}(a.Component),Z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={theme:g.ThemeStyle.Light,fontSize:16},n.pageFontSize=function(){var e=window.getComputedStyle(document.getElementsByTagName("html")[0]).getPropertyValue("font-size");e=e.replace("px","");var t=parseInt(e,10);return t||(t=16),t},n.updateTheme=function(e){var t;switch(e){case"dark":t=g.ThemeStyle.Dark;break;case"contrast":t=g.ThemeStyle.HighContrast;break;case"default":default:t=g.ThemeStyle.Light}n.setState({theme:t})},n.getQueryVariable=function(e){var t=window.location.search.substring(1).split("&"),n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value.split("=");if(decodeURIComponent(c[0])===e)return decodeURIComponent(c[1])}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return null},n.inTeams=function(){try{return window.self!==window.top}catch(e){return!0}},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.updateTheme(this.getQueryVariable("theme")),this.setState({fontSize:this.pageFontSize()}),this.inTeams()&&(f.a.initialize(),f.a.registerOnThemeChangeHandler(this.updateTheme))}},{key:"render",value:function(){var e=Object(g.getContext)({baseFontSize:this.state.fontSize,style:this.state.theme});return r.a.createElement(v.ApolloProvider,{client:E},r.a.createElement(g.TeamsThemeContext.Provider,{value:e},r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement(p.a,{exact:!0,path:"/personal",component:R}),r.a.createElement(p.a,{path:"/team",component:H}),r.a.createElement(p.a,{path:"/configure",component:G}),r.a.createElement(p.a,{path:"/auth/start",component:K}),r.a.createElement(p.a,{path:"/cbresult/:verificationCode/:result",component:X}),r.a.createElement(p.a,{path:"/",component:R})))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},96:function(e,t,n){e.exports=n.p+"static/media/restcommbg.ebb7fd3d.png"}},[[104,2,1]]]);
//# sourceMappingURL=main.ea085241.chunk.js.map